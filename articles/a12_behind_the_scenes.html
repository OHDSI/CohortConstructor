<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Behind the scenes • CohortConstructor</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Behind the scenes">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CohortConstructor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a00_introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/a01_building_base_cohorts.html">Building base cohorts</a></li>
    <li><a class="dropdown-item" href="../articles/a02_cohort_table_requirements.html">Applying cohort table requirements</a></li>
    <li><a class="dropdown-item" href="../articles/a03_require_demographics.html">Applying demographic requirements to a cohort</a></li>
    <li><a class="dropdown-item" href="../articles/a04_require_intersections.html">Applying requirements related to other cohorts, concept sets, or tables</a></li>
    <li><a class="dropdown-item" href="../articles/a05_update_cohort_start_end.html">Updating cohort start and end dates</a></li>
    <li><a class="dropdown-item" href="../articles/a06_concatanate_cohorts.html">Concatenating cohort records</a></li>
    <li><a class="dropdown-item" href="../articles/a07_filter_cohorts.html">Filtering cohorts</a></li>
    <li><a class="dropdown-item" href="../articles/a08_split_cohorts.html">Splitting cohorts</a></li>
    <li><a class="dropdown-item" href="../articles/a09_combine_cohorts.html">Combining Cohorts</a></li>
    <li><a class="dropdown-item" href="../articles/a10_match_cohorts.html">Generating a matched cohort</a></li>
    <li><a class="dropdown-item" href="../articles/a11_benchmark.html">CohortConstructor benchmarking results</a></li>
    <li><a class="dropdown-item" href="../articles/a12_behind_the_scenes.html">Behind the scenes</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/OHDSI/CohortConstructor/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Behind the scenes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/OHDSI/CohortConstructor/blob/main/vignettes/a12_behind_the_scenes.Rmd" class="external-link"><code>vignettes/a12_behind_the_scenes.Rmd</code></a></small>
      <div class="d-none name"><code>a12_behind_the_scenes.Rmd</code></div>
    </div>

    
    
<p>In previous vignettes we have seen numerous R functions that can help
us to add a cohort of interest to a cdm reference. When our cdm
reference is to tables in a database, as is often the code, our R code
will have been translated to SQL that is run against tables in the
databases (for more details on how this is all implemented see <a href="https://ohdsi.github.io/Tidy-R-programming-with-OMOP/" class="external-link uri">https://ohdsi.github.io/Tidy-R-programming-with-OMOP/</a>).</p>
<p>Let’s again work with Eunomia and get the codes needed to create a
set of drug cohorts.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ohdsi.github.io/omock/" class="external-link">omock</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu.github.io/CodelistGenerator/" class="external-link">CodelistGenerator</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu.github.io/PatientProfiles/" class="external-link">PatientProfiles</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ohdsi.github.io/CohortConstructor/">CohortConstructor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ohdsi.github.io/omock/reference/mockCdmFromDataset.html" class="external-link">mockCdmFromDataset</a></span><span class="op">(</span>datasetName <span class="op">=</span> <span class="st">"GiBleed"</span>, source <span class="op">=</span> <span class="st">"duckdb"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">drug_codes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CodelistGenerator/reference/getDrugIngredientCodes.html" class="external-link">getDrugIngredientCodes</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>, </span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"acetaminophen"</span>, <span class="st">"amoxicillin"</span>, <span class="st">"diclofenac"</span>, <span class="st">"simvastatin"</span>, <span class="st">"warfarin"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>To capture all the SQL executed as we use CohortConstructor functions
we can set a global option. For this, we just need to point to a
directory in which we’ll save each SQL statement run behind the scenes.
Note that in this example we’re using duckdb so the SQL is for this
database management system. If you were running on a different type of
database the SQL would be adapted accordingly.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dir_sql</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"sql_folder"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">dir_sql</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"omopgenerics.log_sql_path"</span> <span class="op">=</span> <span class="va">dir_sql</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span><span class="op">$</span><span class="va">drugs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conceptCohort.html">conceptCohort</a></span><span class="op">(</span><span class="va">cdm</span>, </span>
<span>                           conceptSet <span class="op">=</span> <span class="va">drug_codes</span>,</span>
<span>                           exit <span class="op">=</span> <span class="st">"event_end_date"</span>,</span>
<span>                           name <span class="op">=</span> <span class="st">"drugs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print sql in order they were saved</span></span>
<span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.info.html" class="external-link">file.info</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">dir_sql</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sorted_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">files</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">files</span><span class="op">$</span><span class="va">ctime</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">sorted_files</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"### "</span>, <span class="va">sorted_files</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"\n\n"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">sql_with_quotes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'"'</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">sorted_files</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">'\n'</span><span class="op">)</span>, <span class="st">'"'</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">sql_with_quotes</span>, <span class="st">"\n```\n\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00001_on_2025_12_18_at_09_59_25.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.044 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span> vocabulary_version</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> vocabulary</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">WHERE</span> (vocabulary_id = 'None')" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00002_on_2025_12_18_at_09_59_25.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: compute</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; name: tmp_001_og_004_1766051965</span></span>
<span><span class="co">#&gt; temporary: FALSE</span></span>
<span><span class="co">#&gt; overwrite: TRUE</span></span>
<span><span class="co">#&gt; log_prefix: CohortConstructor_uploadCohortCodelist</span></span>
<span><span class="co">#&gt; time_taken: 0.155 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span></span></span>
<span><span class="co">#&gt;     cohort_definition_id,</span></span>
<span><span class="co">#&gt;     CAST(concept_id AS INTEGER)<span style="color: #0000BB;"> AS </span>concept_id,</span></span>
<span><span class="co">#&gt;     LOWER(domain_id)<span style="color: #0000BB;"> AS </span>domain_id</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> (</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">SELECT</span> test_tmp_001_og_004_1766051965.*, domain_id</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">FROM</span> results.test_tmp_001_og_004_1766051965</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">LEFT JOIN</span> concept</span></span>
<span><span class="co">#&gt;       <span style="color: #0000BB;">ON</span> (test_tmp_001_og_004_1766051965.concept_id = concept.concept_id)</span></span>
<span><span class="co">#&gt;   ) q01" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00003_on_2025_12_18_at_09_59_25.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.040 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span> domain_id, COUNT(*)<span style="color: #0000BB;"> AS </span>n</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_tmp_001_og_004_1766051965</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">GROUP BY</span> domain_id" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00004_on_2025_12_18_at_09_59_25.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.027 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT DISTINCT</span> domain_id</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_tmp_001_og_004_1766051965" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00005_on_2025_12_18_at_09_59_25.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.046 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span> COUNT(*)<span style="color: #0000BB;"> AS </span>n</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> (</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">SELECT</span> test_tmp_001_og_004_1766051965.*</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">FROM</span> results.test_tmp_001_og_004_1766051965</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">WHERE</span> (domain_id IN ('drug'))</span></span>
<span><span class="co">#&gt;   ) q01" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00006_on_2025_12_18_at_09_59_25.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: compute</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; name: tmp_001_temp_codelist_cohort_id</span></span>
<span><span class="co">#&gt; temporary: FALSE</span></span>
<span><span class="co">#&gt; overwrite: TRUE</span></span>
<span><span class="co">#&gt; log_prefix: CohortConstructor_tempCodelistCohortId_</span></span>
<span><span class="co">#&gt; time_taken: 0.073 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT DISTINCT</span> cohort_definition_id, concept_id</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_tmp_001_og_004_1766051965</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">WHERE</span> (domain_id IN ('drug'))" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00007_on_2025_12_18_at_09_59_25.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: compute</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; name: tmp_001_temp_codelist</span></span>
<span><span class="co">#&gt; temporary: FALSE</span></span>
<span><span class="co">#&gt; overwrite: TRUE</span></span>
<span><span class="co">#&gt; log_prefix: CohortConstructor_tempCodelist_</span></span>
<span><span class="co">#&gt; time_taken: 0.164 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT DISTINCT</span> concept_id</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_tmp_001_temp_codelist_cohort_id" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00008_on_2025_12_18_at_09_59_26.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: compute</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; name: tmp_001_og_005_1766051966_1</span></span>
<span><span class="co">#&gt; temporary: FALSE</span></span>
<span><span class="co">#&gt; overwrite: TRUE</span></span>
<span><span class="co">#&gt; log_prefix: CohortConstructor_tempCohort_</span></span>
<span><span class="co">#&gt; time_taken: 0.066 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span></span></span>
<span><span class="co">#&gt;     person_id<span style="color: #0000BB;"> AS </span>subject_id,</span></span>
<span><span class="co">#&gt;     drug_concept_id<span style="color: #0000BB;"> AS </span>concept_id,</span></span>
<span><span class="co">#&gt;     drug_exposure_start_date<span style="color: #0000BB;"> AS </span>cohort_start_date,</span></span>
<span><span class="co">#&gt;     drug_exposure_end_date<span style="color: #0000BB;"> AS </span>cohort_end_date</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> drug_exposure</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">INNER JOIN</span> results.test_tmp_001_temp_codelist</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">ON</span> (drug_exposure.drug_concept_id = test_tmp_001_temp_codelist.concept_id)" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00009_on_2025_12_18_at_09_59_26.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: compute</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; name: tmp_001_og_005_1766051966_1</span></span>
<span><span class="co">#&gt; temporary: FALSE</span></span>
<span><span class="co">#&gt; overwrite: TRUE</span></span>
<span><span class="co">#&gt; log_prefix: CohortConstructor_tempCohort_</span></span>
<span><span class="co">#&gt; time_taken: 0.100 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span> cohort_definition_id, subject_id, cohort_start_date, cohort_end_date</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_tmp_001_og_005_1766051966_1</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">INNER JOIN</span> results.test_tmp_001_temp_codelist_cohort_id</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">ON</span> (test_tmp_001_og_005_1766051966_1.concept_id = test_tmp_001_temp_codelist_cohort_id.concept_id)" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00010_on_2025_12_18_at_09_59_26.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.041 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span> COUNT(*)<span style="color: #0000BB;"> AS </span>n</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> (</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">SELECT</span> test_tmp_001_og_005_1766051966_1.*</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">FROM</span> results.test_tmp_001_og_005_1766051966_1</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">LIMIT</span> 1</span></span>
<span><span class="co">#&gt;   ) q01" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00011_on_2025_12_18_at_09_59_26.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: compute</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; name: drugs</span></span>
<span><span class="co">#&gt; temporary: FALSE</span></span>
<span><span class="co">#&gt; overwrite: TRUE</span></span>
<span><span class="co">#&gt; log_prefix: CohortConstructor_conceptCohort_reduce_</span></span>
<span><span class="co">#&gt; time_taken: 0.084 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span></span></span>
<span><span class="co">#&gt;     cohort_definition_id,</span></span>
<span><span class="co">#&gt;     subject_id,</span></span>
<span><span class="co">#&gt;     cohort_start_date,</span></span>
<span><span class="co">#&gt;     COALESCE(cohort_end_date, cohort_start_date)<span style="color: #0000BB;"> AS </span>cohort_end_date</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_tmp_001_og_005_1766051966_1" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00012_on_2025_12_18_at_09_59_26.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.037 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span> COUNT(*)<span style="color: #0000BB;"> AS </span>n</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> (</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">SELECT</span> test_drugs.*</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">LIMIT</span> 1</span></span>
<span><span class="co">#&gt;   ) q01" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00013_on_2025_12_18_at_09_59_26.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.047 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span></span></span>
<span><span class="co">#&gt;     cohort_definition_id,</span></span>
<span><span class="co">#&gt;     COUNT(*)<span style="color: #0000BB;"> AS </span>number_records,</span></span>
<span><span class="co">#&gt;     COUNT(DISTINCT row(subject_id))<span style="color: #0000BB;"> AS </span>number_subjects</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">GROUP BY</span> cohort_definition_id" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00014_on_2025_12_18_at_09_59_26.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.027 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span> test_drugs.*</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">LIMIT</span> 1" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00015_on_2025_12_18_at_09_59_27.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.027 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT DISTINCT</span> cohort_definition_id</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_drugs" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00016_on_2025_12_18_at_09_59_27.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: compute</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; name: drugs</span></span>
<span><span class="co">#&gt; temporary: FALSE</span></span>
<span><span class="co">#&gt; overwrite: TRUE</span></span>
<span><span class="co">#&gt; log_prefix: CohortConstructor_fulfillCohortReqs_observationJoin_</span></span>
<span><span class="co">#&gt; time_taken: 0.106 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span></span></span>
<span><span class="co">#&gt;     test_drugs.*,</span></span>
<span><span class="co">#&gt;     observation_period_id,</span></span>
<span><span class="co">#&gt;     observation_period_start_date,</span></span>
<span><span class="co">#&gt;     observation_period_end_date</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">LEFT JOIN</span> observation_period</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">ON</span> (test_drugs.subject_id = observation_period.person_id)" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00017_on_2025_12_18_at_09_59_27.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: compute</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; name: drugs</span></span>
<span><span class="co">#&gt; temporary: FALSE</span></span>
<span><span class="co">#&gt; overwrite: TRUE</span></span>
<span><span class="co">#&gt; log_prefix: CohortConstructor_fulfillCohortReqs_useRecordsBeforeObservation_</span></span>
<span><span class="co">#&gt; time_taken: 0.156 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span></span></span>
<span><span class="co">#&gt;     cohort_definition_id,</span></span>
<span><span class="co">#&gt;     subject_id,</span></span>
<span><span class="co">#&gt;     cohort_start_date,</span></span>
<span><span class="co">#&gt;     CASE WHEN (observation_period_end_date &gt;= cohort_end_date) THEN cohort_end_date WHEN NOT (observation_period_end_date &gt;= cohort_end_date) THEN observation_period_end_date END<span style="color: #0000BB;"> AS </span>cohort_end_date</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">WHERE</span></span></span>
<span><span class="co">#&gt;     (cohort_start_date &gt;= observation_period_start_date)<span style="color: #0000BB;"> AND</span></span></span>
<span><span class="co">#&gt;     (cohort_start_date &lt;= observation_period_end_date)" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00018_on_2025_12_18_at_09_59_27.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.068 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span></span></span>
<span><span class="co">#&gt;     cohort_definition_id,</span></span>
<span><span class="co">#&gt;     COUNT(*)<span style="color: #0000BB;"> AS </span>number_records,</span></span>
<span><span class="co">#&gt;     COUNT(DISTINCT row(subject_id))<span style="color: #0000BB;"> AS </span>number_subjects</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> (</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">SELECT</span> test_drugs.*</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">WHERE</span> (cohort_definition_id IN (1, 2, 3, 4, 5))</span></span>
<span><span class="co">#&gt;   ) q01</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">GROUP BY</span> cohort_definition_id" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00019_on_2025_12_18_at_09_59_27.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.024 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span> test_drugs.*</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">LIMIT</span> 1" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00020_on_2025_12_18_at_09_59_27.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.026 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT DISTINCT</span> cohort_definition_id</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_drugs" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00021_on_2025_12_18_at_09_59_28.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: compute</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; name: drugs</span></span>
<span><span class="co">#&gt; temporary: FALSE</span></span>
<span><span class="co">#&gt; overwrite: TRUE</span></span>
<span><span class="co">#&gt; log_prefix: CohortConstructor_fulfillCohortReqs_filterStart_</span></span>
<span><span class="co">#&gt; time_taken: 0.093 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span> test_drugs.*</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">WHERE</span> (NOT((cohort_start_date IS NULL)))" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00022_on_2025_12_18_at_09_59_28.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.068 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span></span></span>
<span><span class="co">#&gt;     cohort_definition_id,</span></span>
<span><span class="co">#&gt;     COUNT(*)<span style="color: #0000BB;"> AS </span>number_records,</span></span>
<span><span class="co">#&gt;     COUNT(DISTINCT row(subject_id))<span style="color: #0000BB;"> AS </span>number_subjects</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> (</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">SELECT</span> test_drugs.*</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">WHERE</span> (cohort_definition_id IN (1, 2, 3, 4, 5))</span></span>
<span><span class="co">#&gt;   ) q01</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">GROUP BY</span> cohort_definition_id" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00023_on_2025_12_18_at_09_59_28.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.025 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span> test_drugs.*</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">LIMIT</span> 1" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00024_on_2025_12_18_at_09_59_28.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.028 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT DISTINCT</span> cohort_definition_id</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_drugs" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00025_on_2025_12_18_at_09_59_28.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: compute</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; name: drugs</span></span>
<span><span class="co">#&gt; temporary: FALSE</span></span>
<span><span class="co">#&gt; overwrite: TRUE</span></span>
<span><span class="co">#&gt; log_prefix: CohortConstructor_fulfillCohortReqs_filterStartEnd_</span></span>
<span><span class="co">#&gt; time_taken: 0.134 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span></span></span>
<span><span class="co">#&gt;     cohort_definition_id,</span></span>
<span><span class="co">#&gt;     subject_id,</span></span>
<span><span class="co">#&gt;     cohort_start_date,</span></span>
<span><span class="co">#&gt;     CASE WHEN (cohort_start_date &lt;= cohort_end_date) THEN cohort_end_date WHEN NOT (cohort_start_date &lt;= cohort_end_date) THEN cohort_start_date END<span style="color: #0000BB;"> AS </span>cohort_end_date</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_drugs" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00026_on_2025_12_18_at_09_59_28.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.024 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span> COUNT(*)<span style="color: #0000BB;"> AS </span>n</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_drugs" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00027_on_2025_12_18_at_09_59_28.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: compute</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; name: og_006_1766051969</span></span>
<span><span class="co">#&gt; temporary: FALSE</span></span>
<span><span class="co">#&gt; overwrite: TRUE</span></span>
<span><span class="co">#&gt; log_prefix: CohortConstructor_joinOverlap_workingTbl_</span></span>
<span><span class="co">#&gt; time_taken: 0.163 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span> q01.*, -1.0<span style="color: #0000BB;"> AS </span>date_id</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> (</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">SELECT</span> cohort_definition_id, subject_id, cohort_start_date<span style="color: #0000BB;"> AS </span>date</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;   ) q01</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">UNION ALL</span></span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span> q01.*, 1.0<span style="color: #0000BB;"> AS </span>date_id</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> (</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">SELECT</span> cohort_definition_id, subject_id, cohort_end_date<span style="color: #0000BB;"> AS </span>date</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;   ) q01" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00028_on_2025_12_18_at_09_59_29.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: compute</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; name: og_006_1766051969</span></span>
<span><span class="co">#&gt; temporary: FALSE</span></span>
<span><span class="co">#&gt; overwrite: TRUE</span></span>
<span><span class="co">#&gt; log_prefix: CohortConstructor_joinOverlap_ids_</span></span>
<span><span class="co">#&gt; time_taken: 0.495 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span></span></span>
<span><span class="co">#&gt;     cohort_definition_id,</span></span>
<span><span class="co">#&gt;     subject_id,</span></span>
<span><span class="co">#&gt;     SUM(CAST(era_id AS NUMERIC)) OVER (PARTITION BY cohort_definition_id, subject_id ORDER BY date, date_id ROWS UNBOUNDED PRECEDING)<span style="color: #0000BB;"> AS </span>era_id,</span></span>
<span><span class="co">#&gt;     "name",</span></span>
<span><span class="co">#&gt;     date</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> (</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">SELECT</span></span></span>
<span><span class="co">#&gt;       test_og_006_1766051969.*,</span></span>
<span><span class="co">#&gt;       SUM(date_id) OVER (PARTITION BY cohort_definition_id, subject_id ORDER BY date, date_id ROWS UNBOUNDED PRECEDING)<span style="color: #0000BB;"> AS </span>cum_id,</span></span>
<span><span class="co">#&gt;       CASE WHEN (date_id = -1.0) THEN 'cohort_start_date' WHEN NOT (date_id = -1.0) THEN 'cohort_end_date' END<span style="color: #0000BB;"> AS </span>"name",</span></span>
<span><span class="co">#&gt;       CASE WHEN (date_id = -1.0) THEN 1.0 WHEN NOT (date_id = -1.0) THEN 0.0 END<span style="color: #0000BB;"> AS </span>era_id</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">FROM</span> results.test_og_006_1766051969</span></span>
<span><span class="co">#&gt;   ) q01</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">WHERE</span> (cum_id = 0.0 OR (cum_id = -1.0 AND date_id = -1.0))" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00029_on_2025_12_18_at_09_59_29.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: compute</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; name: og_006_1766051969</span></span>
<span><span class="co">#&gt; temporary: FALSE</span></span>
<span><span class="co">#&gt; overwrite: TRUE</span></span>
<span><span class="co">#&gt; log_prefix: CohortConstructor_joinOverlap_pivot_wider_</span></span>
<span><span class="co">#&gt; time_taken: 0.156 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span></span></span>
<span><span class="co">#&gt;     cohort_definition_id,</span></span>
<span><span class="co">#&gt;     subject_id,</span></span>
<span><span class="co">#&gt;     MAX(CASE WHEN ("name" = 'cohort_start_date') THEN date END)<span style="color: #0000BB;"> AS </span>cohort_start_date,</span></span>
<span><span class="co">#&gt;     MAX(CASE WHEN ("name" = 'cohort_end_date') THEN date END)<span style="color: #0000BB;"> AS </span>cohort_end_date</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_og_006_1766051969</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">GROUP BY</span> cohort_definition_id, subject_id, era_id" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00030_on_2025_12_18_at_09_59_29.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: compute</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; name: drugs</span></span>
<span><span class="co">#&gt; temporary: FALSE</span></span>
<span><span class="co">#&gt; overwrite: TRUE</span></span>
<span><span class="co">#&gt; log_prefix: CohortConstructor_joinOverlap_relocate_</span></span>
<span><span class="co">#&gt; time_taken: 0.153 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT DISTINCT</span> test_og_006_1766051969.*</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_og_006_1766051969" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00031_on_2025_12_18_at_09_59_30.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.069 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span></span></span>
<span><span class="co">#&gt;     cohort_definition_id,</span></span>
<span><span class="co">#&gt;     COUNT(*)<span style="color: #0000BB;"> AS </span>number_records,</span></span>
<span><span class="co">#&gt;     COUNT(DISTINCT row(subject_id))<span style="color: #0000BB;"> AS </span>number_subjects</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> (</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">SELECT</span> test_drugs.*</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">WHERE</span> (cohort_definition_id IN (1, 2, 3, 4, 5))</span></span>
<span><span class="co">#&gt;   ) q01</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">GROUP BY</span> cohort_definition_id" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00032_on_2025_12_18_at_09_59_30.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.028 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span> test_drugs.*</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">LIMIT</span> 1" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00033_on_2025_12_18_at_09_59_30.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.027 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT DISTINCT</span> cohort_definition_id</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_drugs" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00034_on_2025_12_18_at_09_59_30.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.024 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span> test_drugs.*</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">LIMIT</span> 1" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00035_on_2025_12_18_at_09_59_31.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.027 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT DISTINCT</span> cohort_definition_id</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> results.test_drugs" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00036_on_2025_12_18_at_09_59_31.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.066 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span> q01.*</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> (</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">SELECT</span></span></span>
<span><span class="co">#&gt;       subject_id,</span></span>
<span><span class="co">#&gt;       CASE WHEN (cohort_end_date &lt; cohort_start_date) THEN 1 WHEN NOT (cohort_end_date &lt; cohort_start_date) THEN 0 END<span style="color: #0000BB;"> AS </span>end_before_start</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;   ) q01</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">WHERE</span> (end_before_start = 1)" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00037_on_2025_12_18_at_09_59_31.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.147 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span> q01.*</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> (</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">SELECT</span></span></span>
<span><span class="co">#&gt;       subject_id,</span></span>
<span><span class="co">#&gt;       CASE WHEN (cohort_end_date &gt;= next_cohort_start_date) THEN 1 WHEN NOT (cohort_end_date &gt;= next_cohort_start_date) THEN 0 END<span style="color: #0000BB;"> AS </span>overlap</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">FROM</span> (</span></span>
<span><span class="co">#&gt;       <span style="color: #0000BB;">SELECT</span></span></span>
<span><span class="co">#&gt;         test_drugs.*,</span></span>
<span><span class="co">#&gt;         LEAD(cohort_start_date, 1, NULL) OVER (PARTITION BY cohort_definition_id, subject_id ORDER BY cohort_start_date)<span style="color: #0000BB;"> AS </span>next_cohort_start_date</span></span>
<span><span class="co">#&gt;       <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;     ) q01</span></span>
<span><span class="co">#&gt;   ) q01</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">WHERE</span> (overlap = 1)" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00038_on_2025_12_18_at_09_59_31.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.083 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span> q01.*</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> (</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">SELECT</span></span></span>
<span><span class="co">#&gt;       subject_id,</span></span>
<span><span class="co">#&gt;       CASE WHEN ((cohort_definition_id IS NULL) OR (subject_id IS NULL) OR (cohort_start_date IS NULL) OR (cohort_end_date IS NULL)) THEN 1 WHEN NOT ((cohort_definition_id IS NULL) OR (subject_id IS NULL) OR (cohort_start_date IS NULL) OR (cohort_end_date IS NULL)) THEN 0 END<span style="color: #0000BB;"> AS </span>missing</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;   ) q01</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">WHERE</span> (missing = 1)" </span></span>
<span><span class="co">#&gt; ```</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### /tmp/RtmpmxDWr2/sql_folder/logged_query_00039_on_2025_12_18_at_09_59_31.txt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; "type: collect</span></span>
<span><span class="co">#&gt; schema: results</span></span>
<span><span class="co">#&gt; prefix: test_</span></span>
<span><span class="co">#&gt; time_taken: 0.136 seconds</span></span>
<span><span class="co">#&gt; sql: &lt;SQL&gt;</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">SELECT</span> COUNT(*)<span style="color: #0000BB;"> AS </span>n</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB;">FROM</span> (</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">SELECT</span> test_drugs.*</span></span>
<span><span class="co">#&gt;     <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;     WHERE NOT EXISTS (</span></span>
<span><span class="co">#&gt;       <span style="color: #0000BB;">SELECT 1 FROM</span> (</span></span>
<span><span class="co">#&gt;       <span style="color: #0000BB;">SELECT</span></span></span>
<span><span class="co">#&gt;         test_drugs.*,</span></span>
<span><span class="co">#&gt;         observation_period_start_date,</span></span>
<span><span class="co">#&gt;         observation_period_end_date</span></span>
<span><span class="co">#&gt;       <span style="color: #0000BB;">FROM</span> results.test_drugs</span></span>
<span><span class="co">#&gt;       <span style="color: #0000BB;">INNER JOIN</span> observation_period</span></span>
<span><span class="co">#&gt;         <span style="color: #0000BB;">ON</span> (test_drugs.subject_id = observation_period.person_id)</span></span>
<span><span class="co">#&gt;   ) RHS</span></span>
<span><span class="co">#&gt;       <span style="color: #0000BB;">WHERE</span></span></span>
<span><span class="co">#&gt;         (test_drugs.cohort_definition_id = RHS.cohort_definition_id)<span style="color: #0000BB;"> AND</span></span></span>
<span><span class="co">#&gt;         (test_drugs.subject_id = RHS.subject_id)<span style="color: #0000BB;"> AND</span></span></span>
<span><span class="co">#&gt;         (test_drugs.cohort_start_date = RHS.cohort_start_date)<span style="color: #0000BB;"> AND</span></span></span>
<span><span class="co">#&gt;         (test_drugs.cohort_end_date = RHS.cohort_end_date)<span style="color: #0000BB;"> AND</span></span></span>
<span><span class="co">#&gt;         (RHS.cohort_start_date &gt;= RHS.observation_period_start_date AND RHS.cohort_start_date &lt;= RHS.observation_period_end_date AND RHS.cohort_end_date &gt;= RHS.observation_period_start_date AND RHS.cohort_end_date &lt;= RHS.observation_period_end_date)</span></span>
<span><span class="co">#&gt;     )</span></span>
<span><span class="co">#&gt;   ) q01" </span></span>
<span><span class="co">#&gt; ```</span></span></code></pre></div>
<p>If we want even more detail, we also have the option to see the
execution plan along with the SQL.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dir_explain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"explain_folder"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">dir_explain</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"omopgenerics.log_sql_explain_path"</span> <span class="op">=</span> <span class="va">dir_explain</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdm</span><span class="op">$</span><span class="va">drugs</span> <span class="op">&lt;-</span> <span class="va">cdm</span><span class="op">$</span><span class="va">drugs</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/requireIsFirstEntry.html">requireIsFirstEntry</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">dir_explain</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">file_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">dir_explain</span>, full.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">files</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"### "</span>, <span class="va">file_names</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">"\n\n"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">sql_with_quotes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'"'</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">files</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">'\n'</span><span class="op">)</span>, <span class="st">'"'</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">sql_with_quotes</span>, <span class="st">"\n```\n\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward Burn, Martí Català, Nuria Mercade-Besora, Marta Alcalde-Herraiz, Mike Du, Yuchen Guo, Xihang Chen, Kim Lopez-Guell, Elin Rowlands.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
