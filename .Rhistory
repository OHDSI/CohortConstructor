matchSex = TRUE,
matchYearOfBirth = TRUE,
ratio = 4)
a <- generateMatchedCohortSet(cdm,
name = "new_cohort",
targetCohortName = "cases",
targetCohortId = NULL,
matchSex = TRUE,
matchYearOfBirth = TRUE,
ratio = 4)
a
a[["new_cohort"]]
a <- generateMatchedCohortSet(cdm,
name = "new_cohort",
targetCohortName = "cases",
targetCohortId = 1,
matchSex = TRUE,
matchYearOfBirth = TRUE,
ratio = 4)
a
a[["new_cohort"]]
a <- generateMatchedCohortSet(cdm,
name = "new_cohort",
targetCohortName = "cases",
targetCohortId = 1,
matchSex = TRUE,
matchYearOfBirth = TRUE,
ratio = 4)
a[["new_cohort"]]
a <- generateMatchedCohortSet(cdm,
name = "new_cohort",
targetCohortName = "cases",
targetCohortId = 2,
matchSex = TRUE,
matchYearOfBirth = TRUE,
ratio = 4)
a[["new_cohort"]]
name = "new_cohort"
targetCohortName = "cases"
targetCohortId = 2
matchSex = TRUE
matchYearOfBirth = TRUE
ratio = 4
# validate initial input
validateInput(
cdm = cdm, name = name, targetCohortName = targetCohortName,
targetCohortId = targetCohortId, matchSex = matchSex,
matchYearOfBirth = matchYearOfBirth, ratio = ratio
)
# get the number of cohorts
n <- getNumberOfCohorts(cdm, targetCohortName)
n
# get target cohort id
targetCohortId <- getTargetCohortId(cdm, targetCohortId, targetCohortName)
targetCohortId
# Create the cohort name with cases and controls of the targetCohortId
cdm <- getNewCohort(cdm, name, targetCohortName, targetCohortId, n)
cdm
cdm[["new_cohort"]]
cdm[["new_cohort"]] %>% print(n = 10)
cdm[["new_cohort"]] %>% print(n = 15)
cdm[["cases"]]
# Generate mock data
cdmMock <- DrugUtilisation::mockDrugUtilisation(
numberIndividuals = 10,
person = tibble::tibble("person_id" = seq(1,10,1),
"gender_concept_id" = rep(8507,10),
"year_of_birth" = rep(1980, 10),
"day_of_birth"  = rep(1, 10),
"birth_date_time" = rep(as.Date(1980,04,01),10),
"month_of_birth"  = rep(4, 10)),
condition_occurrence = tibble::tibble("condition_ocurrence_id" = seq(1,10,1),
"person_id" = seq(1,10,1),
"condition_concept_id" = c(317009,317009,4266367,4266367,rep(1,6)),
"condition_start_date" = as.Date(c("2017-10-30","2012-01-04","2014-12-15","2004-09-09","2004-08-26","1985-03-31","1985-03-13","1985-07-11","1983-11-07","2020-01-13")),
"condition_end_date"   = as.Date(c("2017-11-01","2012-01-05","2014-12-16","2004-09-10","2004-08-27","1985-04-01","1985-03-14","1985-07-12","1983-11-08","2020-01-14")),
"condition_type_concept_id" = rep(32020,10),
)
)
cdm <- DrugUtilisation::generateConceptCohortSet(
cdm = cdmMock,
conceptSet = list(c1 = 317009, c2 = 4266367),
name = "cases",
end  = "observation_period_end_date",
requiredObservation = c(0,0),
overwrite = TRUE
)
cdm[["cases"]]
# Generate mock data
cdmMock <- DrugUtilisation::mockDrugUtilisation(
numberIndividuals = 10,
person = tibble::tibble("person_id" = seq(1,10,1),
"gender_concept_id" = rep(8532,10),
"year_of_birth" = rep(1980, 10),
"day_of_birth"  = rep(1, 10),
"birth_date_time" = rep(as.Date(1980,04,01),10),
"month_of_birth"  = rep(4, 10)),
condition_occurrence = tibble::tibble("condition_ocurrence_id" = seq(1,10,1),
"person_id" = seq(1,10,1),
"condition_concept_id" = c(317009,317009,4266367,4266367,rep(1,6)),
"condition_start_date" = as.Date(c("2017-10-30","2012-01-04","2014-12-15","2004-09-09","2004-08-26","1985-03-31","1985-03-13","1985-07-11","1983-11-07","2020-01-13")),
"condition_end_date"   = as.Date(c("2017-11-01","2012-01-05","2014-12-16","2004-09-10","2004-08-27","1985-04-01","1985-03-14","1985-07-12","1983-11-08","2020-01-14")),
"condition_type_concept_id" = rep(32020,10),
)
)
cdmMock
cdmMock[["condition_occurrence"]]
# Generate mock data
cdmMock <- DrugUtilisation::mockDrugUtilisation(
numberIndividuals = 10,
person = tibble::tibble("person_id" = seq(1,10,1),
"gender_concept_id" = rep(8532,10),
"year_of_birth" = rep(1980, 10),
"day_of_birth"  = rep(1, 10),
"birth_date_time" = rep(as.Date(1980,04,01),10),
"month_of_birth"  = rep(4, 10)),
condition_occurrence = tibble::tibble("condition_ocurrence_id" = seq(1,10,1),
"person_id" = seq(1,10,1),
"condition_concept_id" = c(317009,317009,4266367,4266367,rep(1,6)),
"condition_start_date" = as.Date(c("2017-10-30","2012-01-04","2014-12-15","2004-09-09","2004-08-26","1985-03-31","1985-03-13","1985-07-11","1983-11-07","2020-01-13")),
"condition_end_date"   = as.Date(c("2017-11-01","2012-01-05","2014-12-16","2004-09-10","2004-08-27","1985-04-01","1985-03-14","1985-07-12","1983-11-08","2020-01-14")),
"condition_type_concept_id" = rep(32020,10),
)
)
cdm <- DrugUtilisation::generateConceptCohortSet(
cdm = cdmMock,
conceptSet = list(c1 = 317009, c2 = 4266367),
name = "cases",
end  = "observation_period_end_date",
requiredObservation = c(0,0),
overwrite = TRUE
)
cdm[["cases"]]
cdm[["observation_period"]]
# Generate mock data
cdmMock <- DrugUtilisation::mockDrugUtilisation(
numberIndividuals = 10,
person = tibble::tibble("person_id" = seq(1,10,1),
"gender_concept_id" = rep(8532,10),
"year_of_birth" = rep(1980, 10),
"day_of_birth"  = rep(1, 10),
"birth_date_time" = rep(as.Date(1980,04,01),10),
"month_of_birth"  = rep(4, 10)),
condition_occurrence = tibble::tibble("condition_ocurrence_id" = seq(1,10,1),
"person_id" = seq(1,10,1),
"condition_concept_id" = c(317009,317009,4266367,4266367,rep(1,6)),
"condition_start_date" = as.Date(c("2017-10-30","2003-01-04","2014-12-15","2010-09-09","2004-08-26","1985-03-31","1985-03-13","1985-07-11","1983-11-07","2020-01-13")),
"condition_end_date"   = as.Date(c("2017-11-01","2003-01-05","2014-12-16","2010-09-10","2004-08-27","1985-04-01","1985-03-14","1985-07-12","1983-11-08","2020-01-14")),
"condition_type_concept_id" = rep(32020,10),
)
)
cdm <- DrugUtilisation::generateConceptCohortSet(
cdm = cdmMock,
conceptSet = list(c1 = 317009, c2 = 4266367),
name = "cases",
end  = "observation_period_end_date",
requiredObservation = c(0,0),
overwrite = TRUE
)
cdm[["cases"]]
generateMatchedCohortSet(cdm,
name = "new_cohort",
targetCohortName = "cases",
targetCohortId = 2,
matchSex = TRUE,
matchYearOfBirth = TRUE,
ratio = 4)
a <- generateMatchedCohortSet(cdm,
name = "new_cohort",
targetCohortName = "cases",
targetCohortId = 2,
matchSex = TRUE,
matchYearOfBirth = TRUE,
ratio = 4)
cdm[["cases"]]
a[["new_cohort"]]
cdm[["observation_period"]]
# Generate mock data
cdmMock <- DrugUtilisation::mockDrugUtilisation(
numberIndividuals = 10,
person = tibble::tibble("person_id" = seq(1,10,1),
"gender_concept_id" = rep(8532,10),
"year_of_birth" = rep(1980, 10),
"day_of_birth"  = rep(1, 10),
"birth_date_time" = rep(as.Date(1980,04,01),10),
"month_of_birth"  = rep(4, 10)),
condition_occurrence = tibble::tibble("condition_ocurrence_id" = seq(1,10,1),
"person_id" = seq(1,10,1),
"condition_concept_id" = c(317009,317009,4266367,4266367,rep(1,6)),
"condition_start_date" = as.Date(c("2017-10-30","2003-01-04","2014-12-15","2010-09-09","2004-08-26","1985-03-31","1985-03-13","1985-07-11","1983-11-07","2020-01-13")),
"condition_end_date"   = as.Date(c("2017-11-01","2003-01-05","2014-12-16","2010-09-10","2004-08-27","1985-04-01","1985-03-14","1985-07-12","1983-11-08","2020-01-14")),
"condition_type_concept_id" = rep(32020,10)),
observation_period = tibble::tibble("observation_period_id" = seq(1,10,1),
"person_id" = seq(1,10,1),
"observation_period_start_date" = rep(as.Date(1950-01-01),10),
"observation_period_end_date"   = rep(as.Date(2023-12-05),10),
"period_type_concept_id"        = 44814724)
)
cdm <- DrugUtilisation::generateConceptCohortSet(
cdm = cdmMock,
conceptSet = list(c1 = 317009, c2 = 4266367),
name = "cases",
end  = "observation_period_end_date",
requiredObservation = c(0,0),
overwrite = TRUE
)
a <- generateMatchedCohortSet(cdm,
name = "new_cohort",
targetCohortName = "cases",
targetCohortId = 2,
matchSex = TRUE,
matchYearOfBirth = TRUE,
ratio = 4)
a
# Generate mock data
cdmMock <- DrugUtilisation::mockDrugUtilisation(
numberIndividuals = 10,
person = tibble::tibble("person_id" = seq(1,10,1),
"gender_concept_id" = rep(8532,10),
"year_of_birth" = rep(1980, 10),
"day_of_birth"  = rep(1, 10),
"birth_date_time" = rep(as.Date(1980,04,01),10),
"month_of_birth"  = rep(4, 10)),
condition_occurrence = tibble::tibble("condition_ocurrence_id" = seq(1,10,1),
"person_id" = seq(1,10,1),
"condition_concept_id" = c(317009,317009,4266367,4266367,rep(1,6)),
"condition_start_date" = as.Date(c("2017-10-30","2003-01-04","2014-12-15","2010-09-09","2004-08-26","1985-03-31","1985-03-13","1985-07-11","1983-11-07","2020-01-13")),
"condition_end_date"   = as.Date(c("2017-11-01","2003-01-05","2014-12-16","2010-09-10","2004-08-27","1985-04-01","1985-03-14","1985-07-12","1983-11-08","2020-01-14")),
"condition_type_concept_id" = rep(32020,10)),
observation_period = tibble::tibble("observation_period_id" = seq(1,10,1),
"person_id" = seq(1,10,1),
"observation_period_start_date" = rep(as.Date(1950-01-01),10),
"observation_period_end_date"   = rep(as.Date(2023-12-05),10),
"period_type_concept_id"        = 44814724)
)
cdm <- DrugUtilisation::generateConceptCohortSet(
cdm = cdmMock,
conceptSet = list(c1 = 317009, c2 = 4266367),
name = "cases",
end  = "observation_period_end_date",
requiredObservation = c(0,0),
overwrite = TRUE
)
a <- generateMatchedCohortSet(cdm,
name = "new_cohort",
targetCohortName = "cases",
targetCohortId = 2,
matchSex = TRUE,
matchYearOfBirth = TRUE,
ratio = 4)
cdm[["cases"]]
# Generate mock data
cdmMock <- DrugUtilisation::mockDrugUtilisation(
numberIndividuals = 10,
person = tibble::tibble("person_id" = seq(1,10,1),
"gender_concept_id" = rep(8532,10),
"year_of_birth" = rep(1980, 10),
"day_of_birth"  = rep(1, 10),
"birth_date_time" = rep(as.Date(1980,04,01),10),
"month_of_birth"  = rep(4, 10)),
condition_occurrence = tibble::tibble("condition_ocurrence_id" = seq(1,10,1),
"person_id" = seq(1,10,1),
"condition_concept_id" = c(317009,317009,4266367,4266367,rep(1,6)),
"condition_start_date" = as.Date(c("2017-10-30","2003-01-04","2014-12-15","2010-09-09","2004-08-26","1985-03-31","1985-03-13","1985-07-11","1983-11-07","2020-01-13")),
"condition_end_date"   = as.Date(c("2017-11-01","2003-01-05","2014-12-16","2010-09-10","2004-08-27","1985-04-01","1985-03-14","1985-07-12","1983-11-08","2020-01-14")),
"condition_type_concept_id" = rep(32020,10)),
observation_period = tibble::tibble("observation_period_id" = seq(1,10,1),
"person_id" = seq(1,10,1),
"observation_period_start_date" = rep(as.Date(1950-01-01),10),
"observation_period_end_date"   = rep(as.Date(2021-12-05),10),
"period_type_concept_id"        = 44814724)
)
cdm <- DrugUtilisation::generateConceptCohortSet(
cdm = cdmMock,
conceptSet = list(c1 = 317009, c2 = 4266367),
name = "cases",
end  = "observation_period_end_date",
requiredObservation = c(0,0),
overwrite = TRUE
)
cdm[["cases"]]
# Generate mock data
cdmMock <- DrugUtilisation::mockDrugUtilisation(
numberIndividuals = 10,
person = tibble::tibble("person_id" = seq(1,10,1),
"gender_concept_id" = rep(8532,10),
"year_of_birth" = rep(1980, 10),
"day_of_birth"  = rep(1, 10),
"birth_date_time" = rep(as.Date(1980,04,01),10),
"month_of_birth"  = rep(4, 10)),
condition_occurrence = tibble::tibble("condition_ocurrence_id" = seq(1,10,1),
"person_id" = seq(1,10,1),
"condition_concept_id" = c(317009,317009,4266367,4266367,rep(1,6)),
"condition_start_date" = as.Date(c("2017-10-30","2003-01-04","2014-12-15","2010-09-09","2004-08-26","1985-03-31","1985-03-13","1985-07-11","1983-11-07","2020-01-13")),
"condition_end_date"   = as.Date(c("2017-11-01","2003-01-05","2014-12-16","2010-09-10","2004-08-27","1985-04-01","1985-03-14","1985-07-12","1983-11-08","2020-01-14")),
"condition_type_concept_id" = rep(32020,10)),
observation_period = tibble::tibble("observation_period_id" = seq(1,10,1),
"person_id" = seq(1,10,1),
"observation_period_start_date" = rep(as.Date(1984-01-01),10),
"observation_period_end_date"   = rep(as.Date(2021-12-05),10),
"period_type_concept_id"        = 44814724)
)
rep(as.Date(1984-01-01),10)
# Generate mock data
cdmMock <- DrugUtilisation::mockDrugUtilisation(
numberIndividuals = 10,
person = tibble::tibble("person_id" = seq(1,10,1),
"gender_concept_id" = rep(8532,10),
"year_of_birth" = rep(1980, 10),
"day_of_birth"  = rep(1, 10),
"birth_date_time" = rep(as.Date(1980,04,01),10),
"month_of_birth"  = rep(4, 10)),
condition_occurrence = tibble::tibble("condition_ocurrence_id" = seq(1,10,1),
"person_id" = seq(1,10,1),
"condition_concept_id" = c(317009,317009,4266367,4266367,rep(1,6)),
"condition_start_date" = as.Date(c("2017-10-30","2003-01-04","2014-12-15","2010-09-09","2004-08-26","1985-03-31","1985-03-13","1985-07-11","1983-11-07","2020-01-13")),
"condition_end_date"   = as.Date(c("2017-11-01","2003-01-05","2014-12-16","2010-09-10","2004-08-27","1985-04-01","1985-03-14","1985-07-12","1983-11-08","2020-01-14")),
"condition_type_concept_id" = rep(32020,10)),
observation_period = tibble::tibble("observation_period_id" = seq(1,10,1),
"person_id" = seq(1,10,1),
"observation_period_start_date" = as.Date(rep("1984-01-01",10)),
"observation_period_end_date"   = as.Date(rep("2021-01-01",10)),
"period_type_concept_id"        = 44814724)
)
cdm <- DrugUtilisation::generateConceptCohortSet(
cdm = cdmMock,
conceptSet = list(c1 = 317009, c2 = 4266367),
name = "cases",
end  = "observation_period_end_date",
requiredObservation = c(0,0),
overwrite = TRUE
)
cdm[["cases"]]
a <- generateMatchedCohortSet(cdm,
name = "new_cohort",
targetCohortName = "cases",
targetCohortId = 2,
matchSex = TRUE,
matchYearOfBirth = TRUE,
ratio = 4)
a[["new_cohort"]]
a <- generateMatchedCohortSet(cdm,
name = "new_cohort",
targetCohortName = "cases",
targetCohortId = NULL,
matchSex = TRUE,
matchYearOfBirth = TRUE,
ratio = 4)
a[["cases"]]
a[["new_cohort"]]
a[["new_cohort"]] %>% print(n = 20)
a[["new_cohort"]] %>%
dplyr::filter(cohort_definition_id %in% c(1,3)) %>%
dplyr::summarise(subject_unique)
a[["new_cohort"]] %>%
dplyr::filter(cohort_definition_id %in% c(1,3)) %>%
dplyr::summarise(subject_id)
a[["new_cohort"]] %>%
dplyr::filter(cohort_definition_id %in% c(1,3)) %>%
dplyr::summarise(subject_id) %>% unique()
a[["new_cohort"]] %>%
dplyr::filter(cohort_definition_id %in% c(1,3)) %>%
dplyr::summarise(subject_id) %>%
distinct()
a[["new_cohort"]] %>%
dplyr::filter(cohort_definition_id %in% c(1,3)) %>%
dplyr::summarise(subject_id) %>%
dplyr::distinct()
a[["new_cohort"]] %>%
dplyr::filter(cohort_definition_id %in% c(1,3)) %>%
dplyr::summarise(subject_id) %>%
dplyr::distinct() %>% dplyr::pull()
a[["new_cohort"]] %>%
dplyr::filter(cohort_definition_id %in% c(1,3)) %>%
dplyr::summarise(subject_id) %>%
dplyr::distinct() %>% dplyr::pull() %>% length() == 10
expect_true(a[["new_cohort"]] %>%
dplyr::filter(cohort_definition_id %in% c(2,4)) %>%
dplyr::summarise(subject_id) %>%
dplyr::distinct() %>% dplyr::pull() %>% length() == 10)
a[["new_cohort"]] %>%
dplyr::filter(cohort_definition_id %in% c(2,4)) %>%
dplyr::summarise(subject_id) %>%
dplyr::distinct() %>% dplyr::pull() %>% length()
a[["new_cohort"]] %>%
dplyr::filter(cohort_definition_id %in% c(2,4))
a[["new_cohort"]] %>%
dplyr::filter(cohort_definition_id %in% c(2,4)) %>%
dplyr::summarise(cohort_start_date) %>%
dplyr::distinct() %>% dplyr::pull() %>% length() == 2
a[["new_cohort"]] %>% dplyr::filter(subject_id == 5)
a[["new_cohort"]] %>% dplyr::filter(subject_id == 5) %>% dplyr::summarise(cohort_start_date) %>% dplyr::arrange() %>% dplyr::pull()
a[["new_cohort"]] %>% dplyr::filter(subject_id == 5) %>% dplyr::summarise(cohort_start_date) %>% dplyr::arrange(desc()) %>% dplyr::pull()
a[["new_cohort"]] %>% dplyr::filter(subject_id == 5) %>% dplyr::summarise(cohort_start_date)
a[["new_cohort"]] %>% dplyr::filter(subject_id == 5) %>% dplyr::summarise(cohort_start_date) %>% dplyr::pull()
a[["new_cohort"]] %>% dplyr::filter(subject_id == 5) %>% dplyr::summarise(cohort_start_date) %>% dplyr::arrange()
as.Date(c("2017-01-01","2019-01-01","2015-01-01"))
arrange(as.Date(c("2017-01-01","2019-01-01","2015-01-01")))
dplyr::arrange(as.Date(c("2017-01-01","2019-01-01","2015-01-01")))
order(as.Date(c("2017-01-01","2019-01-01","2015-01-01")))
as.Date(c("2017-01-01","2019-01-01","2015-01-01"))
as.Date(c("2017-01-01","2019-01-01","2015-01-01")) %>% order()
as.Date(c("2017-01-01","2019-01-01","2015-01-01")) %>% mdy
as.Date(c("2017-01-01","2019-01-01","2015-01-01")) %>% lubridate::mdy()
a[["new_cohort"]] %>% dplyr::filter(subject_id == 5) %>% dplyr::summarise(cohort_start_date) %>% dplyr::pull()
a[["new_cohort"]] %>% dplyr::filter(subject_id == 5) %>% dplyr::summarise(cohort_start_date) %>% dplyr::pull() %in% c("2017-10-30","2003-01-04","2014-12-15","2010-09-09")
expect_true(a[["new_cohort"]] %>%
dplyr::filter(subject_id %in% c(seq(5,10,1)) %>% dplyr::summarise(cohort_start_date) %>% dplyr::pull() %in% c("2017-10-30","2003-01-04","2014-12-15","2010-09-09"))
})
expect_true(a[["new_cohort"]] %>%
dplyr::filter(subject_id %in% c(seq(5,10,1))) %>% dplyr::summarise(cohort_start_date) %>% dplyr::pull() %in% c("2017-10-30","2003-01-04","2014-12-15","2010-09-09"))
expect_true(a[["new_cohort"]] %>%
dplyr::filter(subject_id %in% seq(5,10,1)) %>% dplyr::summarise(cohort_start_date) %>% dplyr::pull() %in% c("2017-10-30","2003-01-04","2014-12-15","2010-09-09"))
expect_true(a[["new_cohort"]] %>%
dplyr::filter(subject_id == 5) %>% dplyr::summarise(cohort_start_date) %>% dplyr::pull() %in% c("2017-10-30","2003-01-04","2014-12-15","2010-09-09"))
outc %>% dplyr::distinct()
outc <- a[["new_cohort"]] %>%
dplyr::filter(subject_id == 5) %>% dplyr::summarise(cohort_start_date) %>% dplyr::pull() %in% c("2017-10-30","2003-01-04","2014-12-15","2010-09-09")
outc %>% dplyr::distinct()
outc == c(TRUE,TRUE)
dplyr::distinct(outc)
unique(outc)
expect_true(unique(outc) == TRUE)
devtools::load_all(".")
devtools::check()
usethis::use_package(tibble,"Suggests")
usethis::use_package(tibble,"Suggests")
usethis::use_package("tibble","Suggests")
devtools::check()
devtools::load_all(".")
devtools::check()
devtools::load_all(".")
devtools::check()
install.packages("DrugUtilisation")
install.packages("DrugUtilisation")
devtools::load_all(".")
devtools::check()
# Generate mock data
cdmMock <- DrugUtilisation::mockDrugUtilisation(
numberIndividuals = 10,
person = tibble::tibble("person_id" = seq(1,10,1),
"gender_concept_id" = rep(8532,10),
"year_of_birth" = rep(1980, 10),
"day_of_birth"  = rep(1, 10),
"birth_date_time" = rep(as.Date(1980,04,01),10),
"month_of_birth"  = rep(4, 10)),
condition_occurrence = tibble::tibble("condition_ocurrence_id" = seq(1,10,1),
"person_id" = seq(1,10,1),
"condition_concept_id" = c(317009,317009,4266367,4266367,rep(1,6)),
"condition_start_date" = as.Date(c("2017-10-30","2003-01-04","2014-12-15","2010-09-09","2004-08-26","1985-03-31","1985-03-13","1985-07-11","1983-11-07","2020-01-13")),
"condition_end_date"   = as.Date(c("2017-11-01","2003-01-05","2014-12-16","2010-09-10","2004-08-27","1985-04-01","1985-03-14","1985-07-12","1983-11-08","2020-01-14")),
"condition_type_concept_id" = rep(32020,10)),
observation_period = tibble::tibble("observation_period_id" = seq(1,10,1),
"person_id" = seq(1,10,1),
"observation_period_start_date" = as.Date(rep("1984-01-01",10)),
"observation_period_end_date"   = as.Date(rep("2021-01-01",10)),
"period_type_concept_id"        = 44814724)
)
help(as.Date)
help(rep)
help(seq)
cdm <- DrugUtilisation::generateConceptCohortSet(
cdm = cdmMock,
conceptSet = list(c1 = 317009, c2 = 4266367),
name = "cases",
end  = "observation_period_end_date",
requiredObservation = c(0,0),
overwrite = TRUE
)
generateMatchedCohortSet(cdm,
name = "new_cohort",
targetCohortName = "cases",
targetCohortId = NULL,
matchSex = TRUE,
matchYearOfBirth = TRUE,
ratio = 4)
a <- generateMatchedCohortSet(cdm,
name = "new_cohort",
targetCohortName = "cases",
targetCohortId = NULL,
matchSex = TRUE,
matchYearOfBirth = TRUE,
ratio = 4)
rep(as.Date(1980,04,01),10)
# Generate mock data
cdmMock <- DrugUtilisation::mockDrugUtilisation(
numberIndividuals = 10,
person = tibble::tibble("person_id" = seq(1,10,1),
"gender_concept_id" = rep(8532,10),
"year_of_birth" = rep(1980, 10),
"day_of_birth"  = rep(1, 10),
"birth_date_time" = rep(as.Date("1980,04,01"),10),
"month_of_birth"  = rep(4, 10)),
condition_occurrence = tibble::tibble("condition_ocurrence_id" = seq(1,10,1),
"person_id" = seq(1,10,1),
"condition_concept_id" = c(317009,317009,4266367,4266367,rep(1,6)),
"condition_start_date" = as.Date(c("2017-10-30","2003-01-04","2014-12-15","2010-09-09","2004-08-26","1985-03-31","1985-03-13","1985-07-11","1983-11-07","2020-01-13")),
"condition_end_date"   = as.Date(c("2017-11-01","2003-01-05","2014-12-16","2010-09-10","2004-08-27","1985-04-01","1985-03-14","1985-07-12","1983-11-08","2020-01-14")),
"condition_type_concept_id" = rep(32020,10)),
observation_period = tibble::tibble("observation_period_id" = seq(1,10,1),
"person_id" = seq(1,10,1),
"observation_period_start_date" = as.Date(rep("1984-01-01",10)),
"observation_period_end_date"   = as.Date(rep("2021-01-01",10)),
"period_type_concept_id"        = 44814724)
)
as.Date(rep("1980,04,01",10))
as.Date(rep("1980,04,01",10))
as.Date(rep("1980-04-01",10))
devtools::load_all(".")
devtools::check()
library(CohortConstructor)
library(CohortConstructor)
