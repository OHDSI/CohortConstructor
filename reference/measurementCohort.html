<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create cohorts measurement based cohorts — measurementCohort • CohortConstructor</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create cohorts measurement based cohorts — measurementCohort"><meta name="description" content="measurementCohort() creates cohorts based on patient records contained
in the measurement table. This function extends the conceptCohort() as it
allows for measurement values associated with the records to be specified.
If valueAsConcept and valueAsNumber are NULL then no requirements on
of the values associated with measurement records and using
measurementCohort() will lead to the same result as using conceptCohort()
(so long as all concepts are from the measurement domain).
If one of valueAsConcept and valueAsNumber is not NULL then records
will be required to have values that satisfy the requirement specified.
If both valueAsConcept and valueAsNumber are not NULL, records will
be required to have values that fulfill either of the requirements

"><meta property="og:description" content="measurementCohort() creates cohorts based on patient records contained
in the measurement table. This function extends the conceptCohort() as it
allows for measurement values associated with the records to be specified.
If valueAsConcept and valueAsNumber are NULL then no requirements on
of the values associated with measurement records and using
measurementCohort() will lead to the same result as using conceptCohort()
(so long as all concepts are from the measurement domain).
If one of valueAsConcept and valueAsNumber is not NULL then records
will be required to have values that satisfy the requirement specified.
If both valueAsConcept and valueAsNumber are not NULL, records will
be required to have values that fulfill either of the requirements

"><meta property="og:image" content="https://ohdsi.github.io/CohortConstructor/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CohortConstructor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a00_introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/a01_building_base_cohorts.html">Building base cohorts</a></li>
    <li><a class="dropdown-item" href="../articles/a02_applying_cohort_restrictions.html">Applying cohort restrictions</a></li>
    <li><a class="dropdown-item" href="../articles/a03_age_sex_matching.html">Generate a matched age and sex cohort</a></li>
    <li><a class="dropdown-item" href="../articles/a04_cohort_manipulations.html">Cohort manipulations</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create cohorts measurement based cohorts</h1>

      <div class="d-none name"><code>measurementCohort.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>measurementCohort()</code> creates cohorts based on patient records contained
in the measurement table. This function extends the <code><a href="conceptCohort.html">conceptCohort()</a></code> as it
allows for measurement values associated with the records to be specified.</p><ul><li><p>If <code>valueAsConcept</code> and <code>valueAsNumber</code> are NULL then no requirements on
of the values associated with measurement records and using
<code>measurementCohort()</code> will lead to the same result as using <code><a href="conceptCohort.html">conceptCohort()</a></code>
(so long as all concepts are from the measurement domain).</p></li>
<li><p>If one of <code>valueAsConcept</code> and <code>valueAsNumber</code> is not NULL then records
will be required to have values that satisfy the requirement specified.</p></li>
<li><p>If both <code>valueAsConcept</code> and <code>valueAsNumber</code> are not NULL, records will
be required to have values that fulfill <em>either</em> of the requirements</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">measurementCohort</span><span class="op">(</span></span>
<span>  <span class="va">cdm</span>,</span>
<span>  <span class="va">conceptSet</span>,</span>
<span>  <span class="va">name</span>,</span>
<span>  valueAsConcept <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  valueAsNumber <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-cdm">cdm<a class="anchor" aria-label="anchor" href="#arg-cdm"></a></dt>
<dd><p>A cdm reference.</p></dd>


<dt id="arg-conceptset">conceptSet<a class="anchor" aria-label="anchor" href="#arg-conceptset"></a></dt>
<dd><p>A conceptSet, which can either be a codelist
or a conceptSetExpression.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>Name of the cohort in the cdm object.</p></dd>


<dt id="arg-valueasconcept">valueAsConcept<a class="anchor" aria-label="anchor" href="#arg-valueasconcept"></a></dt>
<dd><p>A vector of cohort IDs used to filter measurements.
Only measurements with these values in the <code>value_as_concept_id</code> column of
the measurement table will be included. If NULL all entries independently of
their value as concept will be considered.</p></dd>


<dt id="arg-valueasnumber">valueAsNumber<a class="anchor" aria-label="anchor" href="#arg-valueasnumber"></a></dt>
<dd><p>A named list indicating the range of values and the unit
they correspond to, as follows:
list("unit_concept_id" = c(rangeValue1, rangeValue2)). If NULL, all entries
independently of their value as number will be included.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A cohort table</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ohdsi.github.io/CohortConstructor/">CohortConstructor</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="mockCohortConstructor.html">mockCohortConstructor</a></span><span class="op">(</span>con <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cdm</span><span class="op">$</span><span class="va">concept</span> <span class="op">&lt;-</span> <span class="va">cdm</span><span class="op">$</span><span class="va">concept</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/setops.html" class="external-link">union_all</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      concept_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4326744</span>, <span class="fl">4298393</span>, <span class="fl">45770407</span>, <span class="fl">8876</span>, <span class="fl">4124457</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      concept_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Blood pressure"</span>, <span class="st">"Systemic blood pressure"</span>,</span></span>
<span class="r-in"><span>                       <span class="st">"Baseline blood pressure"</span>, <span class="st">"millimeter mercury column"</span>,</span></span>
<span class="r-in"><span>                       <span class="st">"Normal range"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      domain_id <span class="op">=</span> <span class="st">"Measurement"</span>,</span></span>
<span class="r-in"><span>      vocabulary_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SNOMED"</span>, <span class="st">"SNOMED"</span>, <span class="st">"SNOMED"</span>, <span class="st">"UCUM"</span>, <span class="st">"SNOMED"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      standard_concept <span class="op">=</span> <span class="st">"S"</span>,</span></span>
<span class="r-in"><span>      concept_class_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Observable Entity"</span>, <span class="st">"Observable Entity"</span>,</span></span>
<span class="r-in"><span>                           <span class="st">"Observable Entity"</span>, <span class="st">"Unit"</span>, <span class="st">"Qualifier Value"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      concept_code <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>      valid_start_date <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>      valid_end_date <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>      invalid_reason <span class="op">=</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cdm</span><span class="op">$</span><span class="va">measurement</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  measurement_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,</span></span>
<span class="r-in"><span>  person_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  measurement_concept_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4326744</span>, <span class="fl">4298393</span>, <span class="fl">4298393</span>, <span class="fl">45770407</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  measurement_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2000-07-01"</span>, <span class="st">"2000-12-11"</span>, <span class="st">"2002-09-08"</span>,</span></span>
<span class="r-in"><span>                                <span class="st">"2015-02-19"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  measurement_type_concept_id <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>  value_as_number <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">125</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  value_as_concept_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">4124457</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  unit_concept_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8876</span>, <span class="fl">8876</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu">CDMConnector</span><span class="fu">::</span><span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/copy_cdm_to.html" class="external-link">copyCdmTo</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  con <span class="op">=</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">duckdb</span><span class="fu">::</span><span class="fu"><a href="https://r.duckdb.org/reference/duckdb.html" class="external-link">duckdb</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  cdm <span class="op">=</span> <span class="va">cdm</span>, schema <span class="op">=</span> <span class="st">"main"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■    </span>  90% | ETA:  0s</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cdm</span><span class="op">$</span><span class="va">cohort</span> <span class="op">&lt;-</span> <span class="fu">measurementCohort</span><span class="op">(</span></span></span>
<span class="r-in"><span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span></span>
<span class="r-in"><span>  name <span class="op">=</span> <span class="st">"cohort"</span>,</span></span>
<span class="r-in"><span>  conceptSet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"normal_blood_pressure"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4326744</span>, <span class="fl">4298393</span>, <span class="fl">45770407</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  valueAsConcept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4124457</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  valueAsNumber <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"8876"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">70</span>, <span class="fl">120</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Getting records in observation.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Applying measurement requirements.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Creating cohort attributes.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Cohort <span style="font-weight: bold;">cohort</span> created.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cdm</span><span class="op">$</span><span class="va">cohort</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Source:   table&lt;main.cohort&gt; [2 x 4]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Database: DuckDB v1.0.0 [unknown@Linux 6.5.0-1025-azure:R 4.4.1/:memory:]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cohort_definition_id subject_id cohort_start_date cohort_end_date</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>                    1          3 2015-02-19        2015-02-19     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>                    1          1 2000-07-01        2000-07-01     </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward Burn, Marti Catala, Nuria Mercade-Besora, Marta Alcalde-Herraiz, Mike Du, Yuchen Guo, Xihang Chen, Kim Lopez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

