<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create cohorts based on a concept set — conceptCohort • CohortConstructor</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create cohorts based on a concept set — conceptCohort"><meta name="description" content="conceptCohort() creates a cohort table from patient records
from the clinical tables in the OMOP CDM.
The following tables are currently supported for creating concept
cohorts:
condition_occurrence
device_exposure
drug_exposure
measurement
observation
procedure_occurrence
visit_occurrence


Cohort duration is based on record start and end (e.g.
condition_start_date and condition_end_date for records coming
from the condition_occurrence tables). So that the resulting table
satisfies the requirements of an OMOP CDM cohort table:
Cohort entries will not overlap. Overlapping records will be
combined based on the overlap argument.
Cohort entries will not go out of observation. If a record starts
outside of an observation period it will be silently ignored. If a
record ends outside of an observation period it will be trimmed so
as to end at the preceding observation period end date.

"><meta property="og:description" content="conceptCohort() creates a cohort table from patient records
from the clinical tables in the OMOP CDM.
The following tables are currently supported for creating concept
cohorts:
condition_occurrence
device_exposure
drug_exposure
measurement
observation
procedure_occurrence
visit_occurrence


Cohort duration is based on record start and end (e.g.
condition_start_date and condition_end_date for records coming
from the condition_occurrence tables). So that the resulting table
satisfies the requirements of an OMOP CDM cohort table:
Cohort entries will not overlap. Overlapping records will be
combined based on the overlap argument.
Cohort entries will not go out of observation. If a record starts
outside of an observation period it will be silently ignored. If a
record ends outside of an observation period it will be trimmed so
as to end at the preceding observation period end date.

"><meta property="og:image" content="https://ohdsi.github.io/CohortConstructor/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CohortConstructor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a00_introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/a01_building_base_cohorts.html">Building base cohorts</a></li>
    <li><a class="dropdown-item" href="../articles/a02_cohort_table_requirements.html">Applying cohort table requirements</a></li>
    <li><a class="dropdown-item" href="../articles/a03_require_demographics.html">Applying demographic requirements to a cohort</a></li>
    <li><a class="dropdown-item" href="../articles/a04_require_intersections.html">Applying requirements related to other cohorts, concept sets, or tables</a></li>
    <li><a class="dropdown-item" href="../articles/a05_update_cohort_start_end.html">Updating cohort start and end dates</a></li>
    <li><a class="dropdown-item" href="../articles/a06_concatanate_cohorts.html">Concatenating cohort records</a></li>
    <li><a class="dropdown-item" href="../articles/a07_filter_cohorts.html">Filtering cohorts</a></li>
    <li><a class="dropdown-item" href="../articles/a08_split_cohorts.html">Splitting cohorts</a></li>
    <li><a class="dropdown-item" href="../articles/a09_combine_cohorts.html">Combining Cohorts</a></li>
    <li><a class="dropdown-item" href="../articles/a10_match_cohorts.html">Generating a matched cohort</a></li>
    <li><a class="dropdown-item" href="../articles/a11_benchmark.html">CohortConstructor benchmarking results</a></li>
    <li><a class="dropdown-item" href="../articles/a12_behind_the_scenes.html">Behind the scenes</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/OHDSI/CohortConstructor/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create cohorts based on a concept set</h1>
      <small class="dont-index">Source: <a href="https://github.com/OHDSI/CohortConstructor/blob/main/R/conceptCohort.R" class="external-link"><code>R/conceptCohort.R</code></a></small>
      <div class="d-none name"><code>conceptCohort.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>conceptCohort()</code> creates a cohort table from patient records
from the clinical tables in the OMOP CDM.</p>
<p>The following tables are currently supported for creating concept
cohorts:</p><ul><li><p>condition_occurrence</p></li>
<li><p>device_exposure</p></li>
<li><p>drug_exposure</p></li>
<li><p>measurement</p></li>
<li><p>observation</p></li>
<li><p>procedure_occurrence</p></li>
<li><p>visit_occurrence</p></li>
</ul><p>Cohort duration is based on record start and end (e.g.
condition_start_date and condition_end_date for records coming
from the condition_occurrence tables). So that the resulting table
satisfies the requirements of an OMOP CDM cohort table:</p><ul><li><p>Cohort entries will not overlap. Overlapping records will be
combined based on the overlap argument.</p></li>
<li><p>Cohort entries will not go out of observation. If a record starts
outside of an observation period it will be silently ignored. If a
record ends outside of an observation period it will be trimmed so
as to end at the preceding observation period end date.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">conceptCohort</span><span class="op">(</span></span>
<span>  <span class="va">cdm</span>,</span>
<span>  <span class="va">conceptSet</span>,</span>
<span>  <span class="va">name</span>,</span>
<span>  exit <span class="op">=</span> <span class="st">"event_end_date"</span>,</span>
<span>  overlap <span class="op">=</span> <span class="st">"merge"</span>,</span>
<span>  table <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  useRecordsBeforeObservation <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  useSourceFields <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  subsetCohort <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subsetCohortId <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-cdm">cdm<a class="anchor" aria-label="anchor" href="#arg-cdm"></a></dt>
<dd><p>A cdm reference.</p></dd>


<dt id="arg-conceptset">conceptSet<a class="anchor" aria-label="anchor" href="#arg-conceptset"></a></dt>
<dd><p>A conceptSet, which can either be a codelist
or a conceptSetExpression.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>Name of the new cohort table created in the cdm object.</p></dd>


<dt id="arg-exit">exit<a class="anchor" aria-label="anchor" href="#arg-exit"></a></dt>
<dd><p>How the cohort end date is defined. Can be either
"event_end_date" or "event_start_date".</p></dd>


<dt id="arg-overlap">overlap<a class="anchor" aria-label="anchor" href="#arg-overlap"></a></dt>
<dd><p>How to deal with overlapping records. In all
cases cohort start will be set as the earliest start date. If
"merge", cohort end will be the latest end date. If "extend",
cohort end date will be set by adding together the total days
from each of the overlapping records.</p></dd>


<dt id="arg-table">table<a class="anchor" aria-label="anchor" href="#arg-table"></a></dt>
<dd><p>Name of OMOP tables to search for records of the concepts
provided. If NULL, each concept will be search at the assigned domain in
the concept table.</p></dd>


<dt id="arg-userecordsbeforeobservation">useRecordsBeforeObservation<a class="anchor" aria-label="anchor" href="#arg-userecordsbeforeobservation"></a></dt>
<dd><p>If FALSE, only records in observation will
be used. If TRUE, records before the start of observation period will be
considered, with cohort start date set as the start date of the
individuals next observation period (as cohort records must be within
observation).</p></dd>


<dt id="arg-usesourcefields">useSourceFields<a class="anchor" aria-label="anchor" href="#arg-usesourcefields"></a></dt>
<dd><p>If TRUE, the source concept_id fields will also be
used when identifying relevant clinical records. If FALSE, only the standard
concept_id fields will be used.</p></dd>


<dt id="arg-subsetcohort">subsetCohort<a class="anchor" aria-label="anchor" href="#arg-subsetcohort"></a></dt>
<dd><p>A character refering to a cohort table containing
individuals for whom cohorts will be generated. Only individuals in this
table will appear in the generated cohort.</p></dd>


<dt id="arg-subsetcohortid">subsetCohortId<a class="anchor" aria-label="anchor" href="#arg-subsetcohortid"></a></dt>
<dd><p>Optional. Specifies cohort IDs from the <code>subsetCohort</code>
table to include. If none are provided, all cohorts from the <code>subsetCohort</code>
are included.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A cohort table</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ohdsi.github.io/CohortConstructor/">CohortConstructor</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="mockCohortConstructor.html">mockCohortConstructor</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cdm</span><span class="op">$</span><span class="va">cohort</span> <span class="op">&lt;-</span> <span class="fu">conceptCohort</span><span class="op">(</span>cdm <span class="op">=</span> <span class="va">cdm</span>, conceptSet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">444074</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"cohort"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #BBBB00;">!</span> `codelist` casted to integers.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">✖</span> Domain <span style="font-weight: bold;">NA</span> (1 concept) excluded because it is not supported.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> No cohort entries found, returning empty cohort table.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cdm</span><span class="op">$</span><span class="va">cohort</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://darwin-eu.github.io/omopgenerics/reference/attrition.html" class="external-link">attrition</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cohort_definition_id number_records number_subjects reason_id reason          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>                    1              0               0         1 Initial qualify…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2 more variables: excluded_records &lt;int&gt;, excluded_subjects &lt;int&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a cohort based on a concept set. The cohort exit is set to the event start date.</span></span></span>
<span class="r-in"><span><span class="co"># If two records overlap, the cohort end date is set as the sum of the duration of</span></span></span>
<span class="r-in"><span><span class="co"># all overlapping records. Only individuals included in the existing `cohort` will be considered.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">conceptSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"nitrogen"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">35604434</span>, <span class="fl">35604439</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"potassium"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40741270</span>, <span class="fl">42899580</span>, <span class="fl">44081436</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cdm</span><span class="op">$</span><span class="va">study_cohort</span> <span class="op">&lt;-</span> <span class="fu">conceptCohort</span><span class="op">(</span>cdm <span class="op">=</span> <span class="va">cdm</span>,</span></span>
<span class="r-in"><span>                                  conceptSet <span class="op">=</span> <span class="va">conceptSet</span>,</span></span>
<span class="r-in"><span>                                  name <span class="op">=</span> <span class="st">"study_cohort"</span>,</span></span>
<span class="r-in"><span>                                  exit <span class="op">=</span> <span class="st">"event_start_date"</span>,</span></span>
<span class="r-in"><span>                                  overlap <span class="op">=</span> <span class="st">"extend"</span>,</span></span>
<span class="r-in"><span>                                  subsetCohort <span class="op">=</span> <span class="st">"cohort"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span><span style="color: #BBBB00;">!</span> `codelist` casted to integers.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>There are no individuals in the `subsetCohort` and `subsetCohortId` provided.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Returning empty cohort.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cdm</span><span class="op">$</span><span class="va">study_cohort</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://darwin-eu.github.io/omopgenerics/reference/attrition.html" class="external-link">attrition</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cohort_definition_id number_records number_subjects reason_id reason          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>                    1              0               0         1 Qualifying init…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>                    2              0               0         1 Qualifying init…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2 more variables: excluded_records &lt;int&gt;, excluded_subjects &lt;int&gt;</span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward Burn, Martí Català, Nuria Mercade-Besora, Marta Alcalde-Herraiz, Mike Du, Yuchen Guo, Xihang Chen, Kim Lopez-Guell, Elin Rowlands.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

